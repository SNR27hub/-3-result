<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-site-verification" content="BoXN-_xrR1h6w0XDyEKKTVQTRIRWDhRCx9jMS2QUaYA" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Developer SNR - Result Portal</title>
  <!-- Excel Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #74ebd5, #acb6e5);
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
    }
    header {
      background: #4a00e0;
      color: white;
      padding: 25px;
      font-size: 32px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
      width: 100%;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      animation: fadeInScale 1s ease-out;
      position: fixed;
      top: 0;
      z-index: 1000;
    }
    header:hover {
      background: #8e2de2;
    }
    header img {
      width: 24px;
      height: 24px;
    }
    .container {
      margin: 120px auto 20px auto;
      width: 90%;
      max-width: 1000px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      animation: fadeIn 1.2s ease-out;
    }
    
    /* Tabs Design */
    .tabs {
      display: flex;
      gap: 20px;
      margin-bottom: 25px;
      background: rgba(255, 255, 255, 0.3);
      padding: 10px;
      border-radius: 30px;
    }
    .tab-btn {
      padding: 12px 30px;
      border: none;
      border-radius: 25px;
      background: #fff;
      color: #4a00e0;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    .tab-btn.active {
      background: #4a00e0;
      color: white;
      transform: scale(1.1);
      box-shadow: 0 5px 15px rgba(74, 0, 224, 0.4);
    }
    
    input {
      padding: 15px;
      width: 350px;
      max-width: 90%;
      border-radius: 25px;
      border: none;
      outline: none;
      font-size: 18px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
      transition: transform 0.3s ease;
    }
    input:focus {
      transform: scale(1.02);
    }
    button.search-btn {
      padding: 15px 25px;
      margin: 10px;
      border: none;
      border-radius: 25px;
      background: #ff6f61;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.3s ease;
    }
    button.search-btn:hover {
      background: #ff3d2e;
      transform: scale(1.05);
      animation: pulse 0.5s infinite alternate;
    }
    .whatsapp-button {
      background: #25D366;
      margin-top: 15px;
      padding: 12px 20px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border-radius: 25px;
      color: white;
      text-decoration: none;
      font-weight: bold;
      position: relative;
      z-index: 5;
    }
    .whatsapp-button:hover {
      background: #20b358;
      transform: scale(1.05);
      animation: pulse 0.5s infinite alternate;
    }
    .whatsapp-button img {
      width: 24px;
      height: 24px;
    }
    .card {
      margin: 30px auto;
      padding: 30px;
      width: 90%;
      max-width: 800px;
      background: linear-gradient(135deg, #ffffff, #e6e6fa);
      border-radius: 20px;
      box-shadow: 0 15px 30px rgba(0,0,0,0.3), inset 0 0 10px rgba(255,255,255,0.5);
      position: relative;
      text-align: left;
      animation: slideIn 0.7s ease-out;
      border: 2px solid #ffd700;
      overflow: hidden;
    }
    
    /* ---- NEW BIG WATERMARK ---- */
    .watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-30deg);
      font-size: 100px; /* Bada Font */
      font-weight: 900;
      color: rgba(74, 0, 224, 0.1); /* Transparent Purple */
      white-space: nowrap;
      pointer-events: none;
      z-index: 0;
      user-select: none;
    }

    /* Content ko watermark ke upar rakhne ke liye */
    .card h3, .card p, .subject-grid, .verified {
      position: relative;
      z-index: 2;
    }

    .card h3 {
      margin: 10px 0;
      color: #2c3e50;
      font-size: 28px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
    }
    .verified img {
      width: 24px;
      height: 24px;
      margin-left: 8px;
    }
    
    /* Developer Badge Design */
    .dev-badge {
      background-color: #ff4757;
      color: white;
      font-size: 14px;
      font-weight: bold;
      padding: 4px 10px;
      border-radius: 15px;
      margin-left: 8px;
      vertical-align: middle;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      animation: pulse 2s infinite;
    }

    .card p {
      margin: 10px 0;
      color: #34495e;
      font-size: 18px;
    }
    .result-pass {
      color: #2ecc71;
      font-weight: bold;
    }
    .result-fail {
      color: #e74c3c;
      font-weight: bold;
    }
    .subject-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 15px;
      margin-top: 20px;
      padding: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 10px;
      backdrop-filter: blur(5px);
    }
    .subject-grid div {
      font-size: 16px;
      color: #34495e;
    }
    .subject-grid div:nth-child(odd) {
      font-weight: bold;
    }
    .notfound {
      color: #e74c3c;
      font-size: 20px;
      margin-top: 20px;
      animation: shake 0.3s ease;
      text-align: center;
      background: rgba(255,255,255,0.8);
      padding: 20px;
      border-radius: 10px;
    }
    .notice {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
      font-size: 16px;
      color: #34495e;
      text-align: center;
      max-width: 800px;
      width: 90%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .notice p {
      margin: 5px 0;
    }
    .notice .snr-text {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .notice .snr-text img {
      width: 20px;
      height: 20px;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeInScale { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
  </style>
</head>
<body>
  <header onclick="window.open('https://www.instagram.com/snr__27?igsh=MXI4YXd5NnIxMDAzcw==', '_blank')">
    Developer SNR - Result Portal
    <a href="https://postimages.org/" target="_blank"><img src="https://i.postimg.cc/1zk15P0B/badge-18371637-1.png" border="0" alt="badge-18371637-1"/></a>
  </header>

  <div class="container">
    
    <!-- Tab Section -->
    <div class="tabs">
      <button class="tab-btn active" id="btn1" onclick="switchSemester(1)">1st Semester</button>
      <button class="tab-btn" id="btn2" onclick="switchSemester(2)">2nd Semester</button>
    </div>

    <h2 id="semTitle" style="color: #4a00e0; margin-top:0;">Search 1st Semester Result</h2>

    <input type="text" id="searchBox" placeholder="Enter Roll No. or Name">
    <button class="search-btn" onclick="searchResult()">Search</button>
    
    <div id="result"></div>
    
    <div class="notice">
      <p class="snr-text">This website is developed by a student. Developed by SNR <a href="https://postimages.org/" target="_blank"><img src="https://i.postimg.cc/1zk15P0B/badge-18371637-1.png" border="0" alt="badge-18371637-1"/></a></p>
      <p>Results are available for both +3 1st & 2nd Semester.</p>
      <p class="snr-text">ଏହି ୱେବସାଇଟ ଜଣେ ଛାତ୍ରଙ୍କ ଦ୍ୱାରା ବିକଶିତ। SNR ଦ୍ୱାରା ବିକଶିତ। <a href="https://postimages.org/" target="_blank"><img src="https://i.postimg.cc/1zk15P0B/badge-18371637-1.png" border="0" alt="badge-18371637-1"/></a></p>
      <p>ଉଭୟ +୩ ପ୍ରଥମ ଏବଂ ଦ୍ୱିତୀୟ ସେମିଷ୍ଟର ପାଇଁ ଫଳାଫଳ ଉପଲବ୍ଧ।</p>
    </div>
  </div>

  <script>
    let currentSemester = 1;
    let studentsSem1 = [];
    let studentsSem2 = [];

    // --- Data Loading ---

    // Load 1st Sem (Text File)
    fetch("data.txt")
      .then(res => res.text())
      .then(text => { studentsSem1 = parseDataSem1(text); })
      .catch(err => console.error("Error loading Sem 1 data:", err));

    // Load 2nd Sem (Excel File)
    fetch("EGTR_2ND_SEM_NEP.xlsx")
      .then(res => {
        if (!res.ok) throw new Error("Excel file not found");
        return res.arrayBuffer();
      })
      .then(data => {
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet);
        studentsSem2 = parseDataSem2(jsonData);
      })
      .catch(err => console.error("Error loading Sem 2 Excel:", err));

    // --- Parsing Functions (As per your original code) ---

    function parseDataSem1(raw) {
      const lines = raw.split("\n").map(l => l.trim()).filter(l => l.length > 0);
      let data = [];
      lines.forEach(line => {
        let parts = line.split(/\s+/);
        let roll = parts[0].startsWith("N") ? parts[0] : "";
        let subjectStartIndex = parts.findIndex((p, i) => i >= (roll?2:0) && /^[A-Z]{2,3}$/.test(p));
        let name = parts.slice(roll?2:0, subjectStartIndex).join(" ").trim();
        
        let subjects = {};
        let i = subjectStartIndex;
        while (i < parts.length && /^[A-Z]{2,3}$/.test(parts[i])) {
          let subject = parts[i];
          let grade = parts[i + 1];
          if (!subjects[subject]) subjects[subject] = [];
          subjects[subject].push(grade);
          i += 2;
        }
        
        let percentage = (line.match(/\d+\.\d+/) || ["-"])[0];
        let result = line.includes("Pass") ? "Pass" : "Fail";
        let date = line.includes("December, 2024") ? "December, 2024" : "";
        let college = "";
        let idx = line.indexOf("175 -");
        if (idx !== -1) college = line.substring(idx + 5).replace(/Pass|Fail|December, 2024|\d+\.\d+/, "").trim();

        data.push({ roll, name, result, percentage, date, college, subjects, sem: 1 });
      });
      return data;
    }

    function parseDataSem2(jsonData) {
      return jsonData.map(row => {
        const getKey = (key) => Object.keys(row).find(k => k.toLowerCase().includes(key.toLowerCase()));
        
        let name = row[getKey('Name')] || "Unknown";
        let roll = row[getKey('Roll')] || "N/A";
        let college = row[getKey('College')] || "SNR College";
        let result = row[getKey('Result')] || "-";
        let sgpa = row[getKey('SGPA')] || row[getKey('Point')] || "-";
        
        let subjects = {};
        Object.keys(row).forEach(key => {
            let lowerKey = key.toLowerCase();
            // Filter out basic info to keep only subjects
            if(!['name', 'roll', 'college', 'result', 'sgpa', 'point', 'serial', 'sl'].some(x => lowerKey.includes(x))) {
                subjects[key] = [row[key]];
            }
        });

        return {
          roll: String(roll),
          name: String(name),
          result: result,
          percentage: sgpa,
          college: college,
          subjects: subjects,
          sem: 2
        };
      });
    }

    // --- UI Logic ---

    function switchSemester(sem) {
      currentSemester = sem;
      document.getElementById("btn1").classList.toggle("active", sem === 1);
      document.getElementById("btn2").classList.toggle("active", sem === 2);
      document.getElementById("semTitle").innerText = `Search ${sem === 1 ? '1st' : '2nd'} Semester Result`;
      document.getElementById("result").innerHTML = "";
      document.getElementById("searchBox").value = "";
    }

    function searchResult() {
      const query = document.getElementById("searchBox").value.trim().toLowerCase();
      if (!query) return;

      let resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "<p>Searching...</p>";

      let targetArray = currentSemester === 1 ? studentsSem1 : studentsSem2;
      let student = targetArray.find(s => 
        String(s.roll).toLowerCase() === query || String(s.name).toLowerCase().includes(query)
      );
      
      // Developer special check (Manual override if not in file, or just logic handle)
      if (!student && (query === "snr" || query === "shankar meher")) {
         // Create a demo student if real data not found for developer
         student = {
            roll: "Developer-ID",
            name: "Shankar Meher",
            result: "Pass",
            percentage: "9.99",
            college: "SNR College of Technology",
            subjects: { "WEB": ["O"], "JAVA": ["O"], "DB": ["O"] },
            sem: currentSemester
         };
      }

      displayCard(student);
    }

    function displayCard(student) {
      let resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "";

      if (student) {
        let resultClass = String(student.result).toLowerCase().includes("pass") ? "result-pass" : "result-fail";
        let shareText = `Check your +3 ${currentSemester === 1 ? '1st' : '2nd'} Semester results at Developer SNR Result Portal: ${window.location.href}`;
        let whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(shareText)}`;

        // --- SPECIAL DEVELOPER LOGIC START ---
        // Yahan Name, SNR aur Developer Badge ka logic hai
        let displayName = student.name;
        let developerBadgeHTML = "";

        if (displayName.toLowerCase().includes("shankar meher")) {
            // Real Name + (SNR) + Developer Badge
            displayName = `${student.name} (SNR)`;
            developerBadgeHTML = `<span class="dev-badge">Developer</span>`;
        }
        // --- SPECIAL DEVELOPER LOGIC END ---

        // Subject Grid Builder
        let subjectHTML = "";
        for (let [subject, grades] of Object.entries(student.subjects)) {
          if(grades[0] !== undefined) {
             subjectHTML += `<div>${subject}</div><div>${grades.join(", ")}</div>`;
          }
        }

        resultDiv.innerHTML = `
          <div class="card">
            <!-- BADA WATERMARK -->
            <div class="watermark">SNR</div>
            
            <h3>
                ${displayName} 
                ${developerBadgeHTML}
                <a href="https://postimages.org/" target="_blank" class="verified">
                    <img src="https://i.postimg.cc/1zk15P0B/badge-18371637-1.png" border="0" alt="Verified"/>
                </a>
            </h3>
            
            <p><b>Roll No:</b> ${student.roll}</p>
            <p><b>College:</b> ${student.college}</p>
            <p><b>${currentSemester === 1 ? 'Percentage' : 'SGPA/Point'}:</b> ${student.percentage}${currentSemester === 1 ? '%' : ''}</p>
            <p><b>Result:</b> <span class="${resultClass}">${student.result}</span></p>
            ${student.date ? `<p><b>Exam Date:</b> ${student.date}</p>` : ""}
            
            <div class="subject-grid">
              <div><b>Subject</b></div><div><b>Marks/Grade</b></div>
              ${subjectHTML}
            </div>
            
            <a href="${whatsappUrl}" target="_blank" class="whatsapp-button">
              <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
              Share Result
            </a>
          </div>
        `;
      } else {
        resultDiv.innerHTML = `
          <div class="notfound">
            ❌ Result not found in ${currentSemester === 1 ? '1st' : '2nd'} Semester.<br>
            Please check Roll No or Name correctly.
          </div>
        `;
      }
    }
  </script>
</body>
</html>
